package com.henry.leetcode_traning_camp.week_01.day2;

import java.util.ArrayDeque;
import java.util.Deque;

public class Solution_biggest_square_03 {
    public static void main(String[] args) {
        int[] heights = {2,1,5,6,2,3};

        int Smax = biggestRectangleArea(heights);

        System.out.println("æ­¤æŸ±çŠ¶å›¾æ‰€èƒ½å›´æˆçš„æœ€å¤§çŸ©å½¢é¢ç§¯ä¸ºï¼š " + Smax);
    }

    // ä½œç”¨ï¼šè®¡ç®—æŸ±çŠ¶å›¾ä¸­æ‰€èƒ½å‹¾å‹’å‡ºæ¥çš„çŸ©å½¢çš„æœ€å¤§é¢ç§¯ï¼›
    private static int biggestRectangleArea(int[] heights) {
        // ä¸ºäº†ç®€åŒ–æ“ä½œï¼šå‡†å¤‡ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œæ•°ç»„åœ¨åŸå§‹æ•°ç»„å·¦å³éƒ½æ·»åŠ äº†å…ƒç´ 0ï¼›
        int[] tmp = new int[heights.length + 2];

        // æ‹·è´åŸå§‹æ•°ç»„åˆ°ç›®æ ‡æ•°ç»„
        System.arraycopy(heights, 0, tmp, 1, heights.length);

        // å‡†å¤‡ä¸€ä¸ªæ ˆ ä½œä¸ºå•è°ƒæ ˆï¼ˆå•è°ƒæ ˆæ˜¯ä¸æ˜¯ä¸€ç§æ•°æ®ç»“æ„ è¿˜æ˜¯è¯´åªæ˜¯æ ˆçš„ä¸€ç§ç‰¹æ®Šç”¨æ³•ç½¢äº†ï¼‰
        // å•è°ƒæ ˆå°±æ˜¯ æ ˆå†…å…ƒç´ å•è°ƒé€’å¢æˆ–è€…å•è°ƒé€’å‡ çš„æ ˆï¼Œå•è°ƒæ ˆåªèƒ½åœ¨æ ˆé¡¶æ“ä½œã€‚
        Deque<Integer> stack = new ArrayDeque<>();

        // å‡†å¤‡ä¸€ä¸ªintç±»å‹çš„å˜é‡ ç”¨äºè®°å½•å›´æˆçš„çŸ©å½¢çš„é¢ç§¯å¤§å°
        int area = 0;

        // å‡†å¤‡ä¸€ä¸ªå¾ªç¯     éå†æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªæŸ±ä½“ï¼Œä»¥...
        for (int i = 0; i < tmp.length; i++) {
            // å¯¹æ ˆä¸­æŸ±ä½“æ¥è¯´ï¼Œæ ˆä¸­çš„ä¸Šä¸€ä¸ªæŸ±ä½“å°±æ˜¯å…¶ã€Œå·¦è¾¹ç¬¬ä¸€ä¸ªå°äºè‡ªèº«çš„æŸ±ä½“ã€ï¼›
            // è¾¹ç•Œæ„å‘³ç€ä¸èƒ½å€Ÿå¢™ï¼Œaka æ­¤æ—¶å°±èƒ½è®¡ç®—æ­¤æ£’å­æ‰€èƒ½æä¾›çš„Smax

            // è‹¥å½“å‰æŸ±ä½“ i çš„é«˜åº¦ å°äº æ ˆé¡¶æŸ±ä½“çš„é«˜åº¦ï¼Œè¯´æ˜ i æ˜¯æ ˆé¡¶æŸ±ä½“çš„ã€Œå³è¾¹ç¬¬ä¸€ä¸ªå°äºæ ˆé¡¶æŸ±ä½“çš„æŸ±ä½“ã€ aka å½“å‰æŸ±ä½“çš„å³è¾¹ç•Œ
            // å› æ­¤ä»¥ æ ˆé¡¶æŸ±ä½“ ä¸ºé«˜çš„çŸ©å½¢çš„å·¦å³å®½åº¦è¾¹ç•Œå°±ç¡®å®šäº†ï¼Œå¯ä»¥è®¡ç®—é¢ç§¯ğŸŒ¶ï¸ ï½
            while (!stack.isEmpty() && tmp[i] < tmp[stack.peek()]) { // æ ˆé¡¶æŸ±ä½“çš„å³è¾¹ç•Œæ‰¾åˆ°äº†ï¼ˆå·¦è¾¹ç•Œå°±æ˜¯ä¸Šä¸€ä¸ªæŸ±ä½“ï¼‰
                // è®¡ç®—å½“å‰æŸ±ä½“æ‰€èƒ½æä¾›çš„çŸ©å½¢çš„é¢ç§¯
                int h = tmp[stack.pop()]; // å½“å‰æŸ±ä½“çš„é«˜åº¦h
                area = Math.max(area, (i - stack.peek() - 1) * h);   // è®¡ç®—å½“å‰æŸ±ä½“æ‰€èƒ½å›´æˆçš„æœ€å¤§é¢ç§¯ S = h * (right_bound -
                // left_bound - 1)
            }

            // æ ˆä¸­éœ€è¦å¤„ç†çš„æ ˆé¡¶å…ƒç´ éƒ½å¤„ç†å®Œæˆåï¼Œä¼šç»§ç»­æŠŠå½“å‰æŸ±ä½“çš„ç´¢å¼•å…¥æ ˆâ€”â€”â€”â€”å…¥æ ˆåï¼Œæ ˆä¸­çš„å…ƒç´ ä»ä¸‹å¾€ä¸Šæ˜¯é€’å¢çš„ aka æ ˆé¡¶å…ƒç´ çš„å³è¾¹ç•ŒæœªçŸ¥ï¼ˆç­‰å¾…ç ´å±€è€…ï¼‰
            stack.push(i);
        }

        return area;
    } // æ—¶é—´å¤æ‚åº¦ä¸ºO(N)
}
