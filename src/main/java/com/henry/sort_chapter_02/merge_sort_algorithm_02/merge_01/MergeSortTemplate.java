package com.henry.sort_chapter_02.merge_sort_algorithm_02.merge_01;

import edu.princeton.cs.algs4.StdIn;

/*
ä»»åŠ¡æè¿°ï¼šå®Œæ•´åœ°æ’åºæ•°ç»„ = æŠŠæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ’å®šåˆ°å…¶æ­£ç¡®çš„ä½ç½®

é€’å½’æ–¹å¼çš„å¯è¡Œæ€§åˆ†æï¼š
    æ’åºçš„ä»»åŠ¡èƒ½å¤Ÿ ç”¨é€’å½’çš„æ–¹å¼è§£å†³å—ï¼Ÿ
    é€’å½’çš„è¦ç´ ï¼š
        1 åŸå§‹ä»»åŠ¡ èƒ½å¤Ÿåˆ†è§£æˆä¸º è§„æ¨¡æ›´å°çš„åŒç±»å‹ä»»åŠ¡ï¼›
        2 è§£å†³ è§„æ¨¡æ›´å°çš„ä»»åŠ¡ï¼ˆçš„ç»“æœï¼‰èƒ½å¤Ÿå¸®åŠ©è§£å†³åŸå§‹ä»»åŠ¡ã€‚

    å¯¹æ’åºä»»åŠ¡æ¥è¯´, ä»€ä¹ˆæ˜¯è§„æ¨¡æ›´å°çš„ä»»åŠ¡ï¼Ÿ
        æ’åºæ•°ç»„çš„ä¸€éƒ¨åˆ†

    æ’åºæ•°ç»„çš„ä¸€éƒ¨åˆ†ï¼Œèƒ½å¤Ÿå¸®åŠ© â€œå®Œå…¨æ’åºæ•´ä¸ªæ•°ç»„â€å—ï¼Ÿ
        ç­”ï¼šä¸å°½ç„¶ï¼Œå› ä¸ºå³ä½¿æ•°ç»„çš„å±€éƒ¨è¢«æ’åºäº† ä½†å…ƒç´ æœ¬èº«ç¦»å®ƒçš„æ­£ç¡®ä½ç½®è¿˜ä¼šæœ‰ä¸€äº›è·ç¦»
        ä½†å±€éƒ¨æ’åºçš„ç»“æœ(å°é—®é¢˜çš„ç­”æ¡ˆ) æœ‰å¯èƒ½å¸®åŠ© å®Œå…¨æ’åºæ•´ä¸ªæ•°ç»„(åŸå§‹é—®é¢˜çš„ç­”æ¡ˆ)ï¼Œ ä½†æ˜¯å¿…ç„¶éœ€è¦å…¶ä»–æ“ä½œçš„æ”¯æŒ - æ¯”å¦‚æ‰‹ä¸­çš„ç‰Œæ˜¯ JQKA 2345
        å¯¹äºå½’å¹¶æ’åºï¼Œè¿™é‡Œçš„â€œå…¶ä»–æ“ä½œâ€ â€”â€”â€”â€” å½’å¹¶æ“ä½œã€‚

æœ¯è¯­å®šä¹‰ï¼š
    æœ‰åºçš„å­æ•°ç»„ï¼šå­æ•°ç»„ä¸­çš„ç›¸é‚»å…ƒç´ è¿ç»­å‡åºæˆ–é™åºæ’åˆ—ï¼›
    å½’å¹¶æ“ä½œï¼š ä» ä¸¤ä¸ªæœ‰åºçš„æ•°ç»„ï¼Œå¾—åˆ°ä¸€ä¸ªæ›´å¤§çš„æœ‰åºæ•°ç»„çš„æ“ä½œã€‚
        åº”ç”¨ï¼š ä½œä¸ºåŸºç¡€æ“ä½œï¼Œæ¥ æ”¯æŒå½’å¹¶æ’åºã€‚
        æ ¹æ®å½’å¹¶æ“ä½œè®¾è®¡æ–¹æ³•ï¼š
            ä½œç”¨ï¼šæŠŠa[leftBar, middle] ä¸ a[middle+1, rightBar]ä¸¤ä¸ªæœ‰åºçš„å­æ•°ç»„è¿›è¡Œå½’å¹¶ï¼Œå¹¶æŠŠç»“æœå­˜å›åˆ°a[leftBar, rightBar]ä¸­
            æ–¹æ³•ç­¾åï¼š
                merge(Comparable[] a, int leftBar, int middle, int rightBar)
    tipï¼š
        å¯ä»¥æŠŠè¾…åŠ©æ•°ç»„è®¾è®¡æˆä¸ºâ€œæˆå‘˜å˜é‡â€, ç„¶åâ€œåœ¨sort()æ–¹æ³•ä¸­è¿›è¡Œåˆå§‹åŒ–â€å³å¯

æ’åºç®—æ³•æè¿°ï¼š
    #1 æŠŠåŸå§‹æ•°ç»„åˆ†ç»„ä¸ºå¤šä¸ªå­æ•°ç»„ï¼›
    #2 å¯¹åˆ†å‰²å¾—åˆ°çš„å­æ•°ç»„ï¼Œä¸¤ä¸¤ä¹‹é—´æ‰§è¡Œå½’å¹¶æ“ä½œï¼›
    #3 åœ¨æ‰§è¡Œ ä¸¤ä¸ªåŸå§‹æ•°ç»„ä¸€åŠçš„å­æ•°ç»„ï¼ˆæœ‰åºï¼‰ä¹‹é—´çš„å½’å¹¶æ“ä½œåï¼Œå¾—åˆ°â€œå®Œå…¨æ’åºçš„æ•°ç»„â€ã€‚

æ’åºç®—æ³•è¿‡ç¨‹ï¼š
    #1 æŠŠåŸå§‹æ•°ç»„è§†ä¸º [0, a.length]çš„åŒºé—´ï¼›
    #2 ä½¿ç”¨æ’åºæ–¹æ³•ï¼Œå¯¹å…¶å·¦åŠåŒºé—´ã€å³åŠåŒºé—´æ‰§è¡Œæ’åºï¼›
    #3 å·¦åŠåŒºé—´ä¸å³åŠåŒºé—´éƒ½æœ‰åºåï¼Œæ‰§è¡Œå®ƒä»¬ä¹‹é—´çš„å½’å¹¶æ“ä½œï¼Œå³å¯å¾—åˆ°â€œå®Œå…¨æ’åºçš„æ•°ç»„â€ã€‚

å½’å¹¶ç®—æ³•è¿‡ç¨‹ï¼šï¼ˆå‚æ•°æ˜¯ä¸¤ä¸ªåŒºé—´çš„è¾¹ç•Œï¼‰
    #1 æ‹·è´åŸå§‹æ•°ç»„çš„æŒ‡å®šåŒºé—´ åˆ°è¾…åŠ©æ•°ç»„ä¸­ï¼›
    #2 ä¸ºè¾…åŠ©æ•°ç»„çš„å·¦å³åŒºé—´ï¼Œæ·»åŠ éå†æŒ‡é’ˆï¼›
    #3 æ¯”è¾ƒå·¦åŠåŒºé—´ä¸å³åŠåŒºé—´çš„å…ƒç´ ï¼ŒæŠŠè¾ƒå°å…ƒç´ æ‹·è´å›å»â€œåŸæ•°ç»„â€ã€‚


æ–¹æ³•ç­¾åè®¾è®¡ï¼š
    publicæ–¹æ³•ç­¾åï¼š
        publicçš„æ–¹æ³•ç­¾å - sort(Comparable[] a) // ä¼ å…¥ä¸€ä¸ªæ•°ç»„è¿›è¡Œæ’åº

    privateæ–¹æ³•ç­¾åï¼š
        å¦‚ä½•åœ¨æ–¹æ³•ç­¾åå±‚é¢ï¼Œä½“ç°å‡º â€œè§„æ¨¡æ›´å°çš„æ’åºâ€å‘¢ï¼Ÿ
        ç­”ï¼šåœ¨â€œæ–¹æ³•ç­¾åâ€ä¸­æ·»åŠ  â€œåŸåœ°æ’åºçš„æ’åºåŒºé—´â€
        åˆæ­¥è®¾è®¡ï¼š sort(Comparable[] a, int leftBar, int rightBar)

reminder: using the params
 */
public class MergeSortTemplate {
    // æŠŠè¾…åŠ©æ•°ç»„å£°æ˜ä¸ºæˆå‘˜å˜é‡ - å¥½å¤„ï¼šå¯ä»¥åœ¨å½“å‰ç±»çš„æ‰€æœ‰æ–¹æ³•ä¸­ä½¿ç”¨å®ƒ
    private static Comparable[] aux;

    // publicæ–¹æ³• - ä¼ å…¥å¾…æ’åºçš„æ•°ç»„
    public static void sort(Comparable[] a) {
        // ğŸ– åœ¨sort()æ–¹æ³•ä¸­ åˆå§‹åŒ–è¾…åŠ©æ•°ç»„çš„å¤§å°
        aux = new Comparable[a.length];

        // å¯¹â€œæ•°ç»„çš„æŒ‡å®šåŒºé—´â€è¿›è¡Œæ’åº - è¿™é‡Œæ˜¯å…¨éƒ¨åŒºé—´
        sortRange(a, 0, a.length - 1);
    }

    // æ’åºâ€œæ•°ç»„çš„æŒ‡å®šåŒºé—´â€ a[leftBar, rightBar] é—­åŒºé—´
    // æ‰‹æ®µï¼šé€’å½’
    private static void sortRange(Comparable[] a, int leftBar, int rightBar) {
        // é€’å½’ç»ˆç»“çš„æ¡ä»¶ï¼šåŒºé—´å˜çª„ä¸º0
        if(leftBar >= rightBar) return;

        // è®¡ç®—å½“å‰åŒºé—´çš„ä¸­é—´ä½ç½®
        int middle = leftBar + (rightBar - leftBar) / 2;

        // #1 ä½¿å·¦åŒºé—´æœ‰åº
        sortRange(a, leftBar, middle);
        // #2 ä½¿å³åŒºé—´æœ‰åº
        sortRange(a, middle+1, rightBar);

        // #3 æœ‰äº†ä¸¤ä¸ªâ€œæœ‰åºçš„å­æ•°ç»„â€åï¼Œä½¿ç”¨å½’å¹¶æ“ä½œ å¾—åˆ°ä¸€ä¸ª â€œå…ƒç´ å®Œå…¨æœ‰åºçš„æ•°ç»„â€
        mergeSortedRange(a, leftBar, middle, rightBar);
    }

    // å½’å¹¶â€œåŸå§‹æ•°ç»„â€ä¸­çš„ä¸¤ä¸ªâ€œæœ‰åºå­æ•°ç»„â€
    // å½’å¹¶ a[leftBar, middle] ä¸ a[middle+1, rightBar] - ç‰¹å¾ï¼šä¸¤ä¸ªå­åŒºé—´éƒ½å·²ç»æ˜¯æœ‰åºæ•°ç»„äº†
    private static void mergeSortedRange(Comparable[] a, int leftBar, int middle, int rightBar) {
        // #1 æ‹·è´åŒºé—´[leftBar, rightBar](é—­åŒºé—´)ä¹‹é—´çš„å…ƒç´  åˆ° aux
        for (int cursor = leftBar; cursor <= rightBar; cursor++) {
            aux[cursor] = a[cursor];
        }

        // #2 å‡†å¤‡å·¦åŒºé—´çš„æŒ‡é’ˆ ä¸ å³åŒºé—´çš„æŒ‡é’ˆ - åˆå§‹ä½ç½®æ”¾åœ¨æœ€å·¦ä¾§
        int leftHalfCursor = leftBar;
        int rightHalfCursor = middle + 1;

        // #3 å¡«å……åŸæ•°ç»„ï¼ˆä½¿ç”¨è¾…åŠ©æ•°ç»„aux min(å·¦åŠåŒºé—´, å³åŠåŒºé—´)ï¼‰
        for (int cursor = leftBar; cursor <= rightBar; cursor++) {
            // å·¦åŠéƒ¨åˆ†å…ƒç´ ç”¨å°½
            if(leftHalfCursor > middle) a[cursor] = aux[rightHalfCursor++];
            // å³åŠéƒ¨åˆ†å…ƒç´ ç”¨å°½
            else if(rightHalfCursor > rightBar) a[cursor] = aux[leftHalfCursor++];
            // æ¯”è¾ƒå·¦å³â€œæŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ â€ï¼Œç„¶åï¼š#1 æ‹·è´ è¾ƒå°å€¼ åˆ°åŸæ•°ç»„ä¸­; #2 å¹¶ç§»åŠ¨æŒ‡é’ˆåˆ°ä¸‹ä¸€ä½ç½®
            else if(less(aux[leftHalfCursor], aux[rightHalfCursor])) a[cursor] = aux[leftHalfCursor++];
            else a[cursor] = aux[rightHalfCursor++];
        }
    }

    private static boolean less(Comparable v, Comparable w) {
        return v.compareTo(w) < 0;
    }

    private static void printItems(Comparable[] a) {
        int N = a.length;
        for (int i = 0; i < N; i++) {
            System.out.print(a[i] + " ");
        }

        System.out.println();
    }

    public static void main(String[] args) {
//        String[] a = {"M", "E", "R", "G", "E", "S", "O", "R", "T", "E", "X", "A", "M", "P", "L", "E"};
        String[] a = StdIn.readAllStrings();
        sort(a);

        printItems(a);
    }
}
